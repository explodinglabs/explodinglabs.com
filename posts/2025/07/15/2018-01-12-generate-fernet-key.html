<div class="wide-logos">
  <p><img src="/posts/assets/airflow.png" alt="airflow" /></p>
</div>

<p>Install cryptography:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>cryptography
</code></pre></div></div>

<p>Generate a fernet key:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-c</span> <span class="s2">"from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"</span>
<span class="nv">81HqDtbqAywKSOumSha3BhWNOdQ26slT6K0YaZeZyPs</span><span class="o">=</span>
</code></pre></div></div>

<h2 id="use-a-fernet-key-with-airflow">Use a fernet key with Airflow</h2>

<p>Paste the key into your <code class="language-plaintext highlighter-rouge">airflow.cfg</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fernet_key = 81HqDtbqAywKSOumSha3BhWNOdQ26slT6K0YaZeZyPs=
</code></pre></div></div>

<p>Alternatively, set the environment variable.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">AIRFLOW__CORE__FERNET_KEY</span><span class="o">=</span><span class="s1">'81HqDtbqAywKSOumSha3BhWNOdQ26slT6K0YaZeZyPs='</span>
</code></pre></div></div>

<p>Restart Airflowâ€™s webserver.</p>

<div class="warning">
  <p>For existing connections (the ones that were defined before setting the Fernet
key), you need to open each connection in the web admin, re-type the password
and save it.</p>
</div>
